#!/usr/bin/env bash

if [[ "$1" == "--mod" ]]; then
    if [[ ! -f src/mod/mod_main.c ]]; then
        cp mod_main.c src/mod/mod_main.c
    fi
    gcc tools/n64crc/n64crc.c -o tools/n64crc/n64crc.exe
    python3 tools/splat/split.py chameleontwist.jp.yaml
    python3 mod_configure.py "$@"
    
else
    if [[ -d src/mod ]]; then
        read -p "A normal configure will delete src/mod. Continue? (y/n): " answer
        if [[ "$answer" == "y" || "$answer" == "Y" ]]; then
            rm -r src/mod
            python3 tools/splat/split.py chameleontwist.jp.yaml
            python3 configure.py "$@"
        fi
    else
        python3 tools/splat/split.py chameleontwist.jp.yaml
        python3 configure.py "$@"
    fi
fi


